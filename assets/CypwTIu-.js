import{E as S,G as x,f as F,H as I,I as $,J as H,K as U,i as k,L as G,M as W,k as J,N as T,O as Q,P as X,Q as q,A as l,R as Y,_ as Z,U as K,c as p,a as r,z as B,t as D,d as E,V as A,F as ee,x as ae,W as te,X as se,o as b}from"./TJ7jymPr.js";import{u as ne}from"./BVJTnKT0.js";const oe={trailing:!0};function ie(e,a=25,u={}){if(u={...oe,...u},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let d,o,c=[],t,n;const v=(i,s)=>(t=re(e,i,s),t.finally(()=>{if(t=null,u.trailing&&n&&!o){const g=v(i,n);return n=null,g}}),t);return function(...i){return t?(u.trailing&&(n=i),t):new Promise(s=>{const g=!o&&u.leading;clearTimeout(o),o=setTimeout(()=>{o=null;const P=u.leading?d:v(this,i);for(const y of c)y(P);c=[]},a),g?(d=v(this,i),s(d)):c.push(s)})}}async function re(e,a,u){return await e.apply(a,u)}const le=Symbol.for("nuxt:client-only");function ce(...e){const a=typeof e[e.length-1]=="string"?e.pop():void 0;ue(e[0],e[1])&&e.unshift(a);let[u,d,o={}]=e;const c=S(()=>x(u));if(typeof c.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof d!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const t=F();o.server??=!0,o.default??=fe,o.getCachedData??=V,o.lazy??=!1,o.immediate??=!0,o.deep??=I.deep,o.dedupe??="cancel",o._functionName,t._asyncData[c.value];const n={cause:"initial",dedupe:o.dedupe};t._asyncData[c.value]?._init||(n.cachedData=o.getCachedData(c.value,t,{cause:"initial"}),t._asyncData[c.value]=j(t,c.value,d,o,n.cachedData));const v=t._asyncData[c.value];v._deps++;const i=()=>t._asyncData[c.value].execute(n),s=o.server!==!1&&t.payload.serverRendered;{let y=function(f){const m=t._asyncData[f];m?._deps&&(m._deps--,m._deps===0&&m?._off())};const _=$();if(_&&s&&o.immediate&&!_.sp&&(_.sp=[]),_&&!_._nuxtOnBeforeMountCbs){_._nuxtOnBeforeMountCbs=[];const f=_._nuxtOnBeforeMountCbs;H(()=>{f.forEach(m=>{m()}),f.splice(0,f.length)}),U(()=>f.splice(0,f.length))}const w=_&&(_._nuxtClientOnly||k(le,!1));s&&t.isHydrating&&(v.error.value||v.data.value!==void 0)?v.status.value=v.error.value?"error":"success":_&&(!w&&t.payload.serverRendered&&t.isHydrating||o.lazy)&&o.immediate?_._nuxtOnBeforeMountCbs.push(i):o.immediate&&v.status.value!=="success"&&i();const h=Y(),C=G([c,...o.watch||[]],([f],[m])=>{if((f||m)&&f!==m){const O=t._asyncData[m]?.data.value!==void 0,z=t._asyncDataPromises[m]!==void 0;m&&y(m);const M={cause:"initial",dedupe:o.dedupe};if(!t._asyncData[f]?._init){let R;m&&O?R=t._asyncData[m]?.data.value:(R=o.getCachedData(f,t,{cause:"initial"}),M.cachedData=R),t._asyncData[f]=j(t,f,d,o,R)}t._asyncData[f]._deps++,(o.immediate||O||z)&&t._asyncData[f].execute(M)}else v._execute({cause:"watch",dedupe:o.dedupe})},{flush:"sync"});h&&W(()=>{C(),y(c.value)})}const g={data:N(()=>t._asyncData[c.value]?.data),pending:N(()=>t._asyncData[c.value]?.pending),status:N(()=>t._asyncData[c.value]?.status),error:N(()=>t._asyncData[c.value]?.error),refresh:(...y)=>t._asyncData[c.value].execute(...y),execute:(...y)=>t._asyncData[c.value].execute(...y),clear:()=>L(t,c.value)},P=Promise.resolve(t._asyncDataPromises[c.value]).then(()=>g);return Object.assign(P,g),P}function N(e){return S({get(){return e()?.value},set(a){const u=e();u&&(u.value=a)}})}function ue(e,a){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof a=="function")}function L(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=void 0),e._asyncData[a]&&(e._asyncData[a].data.value=l(e._asyncData[a]._default()),e._asyncData[a].error.value=void 0,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}function de(e,a){const u={};for(const d of a)u[d]=e[d];return u}function j(e,a,u,d,o){e.payload._errors[a]??=void 0;const c=d.getCachedData!==V,t=u,n=d.deep?J:T,v=o!==void 0,i=e.hook("app:data:refresh",async g=>{(!g||g.includes(a))&&await s.execute({cause:"refresh:hook"})}),s={data:n(v?o:d.default()),pending:S(()=>s.status.value==="pending"),error:Q(e.payload._errors,a),status:T("idle"),execute:(...g)=>{const[P,y=void 0]=g,_=P&&y===void 0&&typeof P=="object"?P:{};if(e._asyncDataPromises[a]){if((_.dedupe??d.dedupe)==="defer")return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}{const h="cachedData"in _?_.cachedData:d.getCachedData(a,e,{cause:_.cause??"refresh:manual"});if(h!==void 0)return e.payload.data[a]=s.data.value=h,s.error.value=void 0,s.status.value="success",Promise.resolve(h)}s.status.value="pending";const w=new Promise((h,C)=>{try{h(t(e))}catch(f){C(f)}}).then(async h=>{if(w.cancelled)return e._asyncDataPromises[a];let C=h;d.transform&&(C=await d.transform(h)),d.pick&&(C=de(C,d.pick)),e.payload.data[a]=C,s.data.value=C,s.error.value=void 0,s.status.value="success"}).catch(h=>{if(w.cancelled)return e._asyncDataPromises[a];s.error.value=q(h),s.data.value=l(d.default()),s.status.value="error"}).finally(()=>{w.cancelled||delete e._asyncDataPromises[a]});return e._asyncDataPromises[a]=w,e._asyncDataPromises[a]},_execute:ie((...g)=>s.execute(...g),0,{leading:!0}),_default:d.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{i(),e._asyncData[a]?._init&&(e._asyncData[a]._init=!1),c||X(()=>{e._asyncData[a]?._init||(L(e,a),s.execute=()=>Promise.resolve())})}};return s}const fe=()=>{},V=(e,a,u)=>{if(a.isHydrating)return a.payload.data[e];if(u.cause!=="refresh:manual"&&u.cause!=="refresh:hook")return a.static.data[e]},_e={key:0,class:"movie-container",role:"main","aria-label":"Movie Details"},me={class:"hero-content"},ve=["src"],ge={class:"info"},he={key:0,class:"tagline",tabindex:"0"},De={class:"overview",tabindex:"0"},ye={class:"meta","aria-label":"Movie metadata"},pe={class:"links","aria-label":"External links"},be=["href"],Ce=["href"],Pe={key:1,class:"collection","aria-label":"Belongs to collection"},we=["src","alt"],Ee={tabindex:"0"},Re={key:0,class:"production","aria-label":"Production Companies"},Be={class:"logos"},Ne=["src","alt"],Se={key:1},Oe={key:1,class:"loading",role:"alert","aria-live":"assertive"},Me={__name:"[id]",async setup(e){let a,u;const d=te(),o=se(),c=()=>{o.back()},{fetchMovieDetails:t}=ne(),{data:n}=([a,u]=K(()=>ce("movie",()=>t(d.params.id))),a=await a,u(),a);return(v,i)=>l(n)?(b(),p("div",_e,[r("button",{class:"back-button",onClick:c},"← Back"),r("section",{class:"hero",style:A({backgroundImage:l(n).backdrop_path?`linear-gradient(to right, rgba(0,0,0,0.85), rgba(0,0,0,0.1)), url(https://image.tmdb.org/t/p/original${l(n).backdrop_path})`:"none"})},[r("div",me,[r("img",{class:"poster",src:l(n).poster_path?`https://image.tmdb.org/t/p/w500${l(n).poster_path}`:"",loading:"lazy",onError:i[0]||(i[0]=s=>{s.target.style.display="none",s.target.nextElementSibling.style.display="flex"})},null,40,ve),i[7]||(i[7]=r("div",{class:"poster-fallback",role:"img","aria-label":"No poster available"},"No Image",-1)),r("article",ge,[r("h1",null,D(l(n).title),1),l(n).tagline?(b(),p("p",he,"“"+D(l(n).tagline)+"”",1)):B("",!0),r("p",De,D(l(n).overview),1),r("section",ye,[r("p",null,[i[1]||(i[1]=r("strong",null,"Genres:",-1)),E(" "+D(l(n).genres.map(s=>s.name).join(", ")),1)]),r("p",null,[i[2]||(i[2]=r("strong",null,"Runtime:",-1)),E(" "+D(l(n).runtime)+" min",1)]),r("p",null,[i[3]||(i[3]=r("strong",null,"Release Date:",-1)),E(" "+D(new Date(l(n).release_date).toLocaleDateString()),1)]),r("p",null,[i[4]||(i[4]=r("strong",null,"Rating:",-1)),E(" ⭐ "+D(l(n).vote_average.toFixed(1))+" / 10 ("+D(l(n).vote_count.toLocaleString())+" votes)",1)]),r("p",null,[i[5]||(i[5]=r("strong",null,"Language:",-1)),E(" "+D(l(n).spoken_languages.map(s=>s.english_name).join(", ")),1)]),r("p",null,[i[6]||(i[6]=r("strong",null,"Country:",-1)),E(" "+D(l(n).production_countries.map(s=>s.name).join(", ")),1)])]),r("nav",pe,[r("a",{href:`https://www.imdb.com/title/${l(n).imdb_id}`,target:"_blank",rel:"noopener noreferrer"},"View on IMDb",8,be),l(n).homepage?(b(),p("a",{key:0,href:l(n).homepage,target:"_blank",rel:"noopener noreferrer"},"Official Site",8,Ce)):B("",!0)]),l(n).belongs_to_collection?(b(),p("section",Pe,[r("img",{src:`https://image.tmdb.org/t/p/w200${l(n).belongs_to_collection.poster_path}`,alt:`Collection poster: ${l(n).belongs_to_collection.name}`,loading:"lazy"},null,8,we),r("p",Ee,D(l(n).belongs_to_collection.name),1)])):B("",!0)])])],4),l(n).production_companies.length?(b(),p("section",Re,[i[8]||(i[8]=r("h2",null,"Production Companies",-1)),r("div",Be,[(b(!0),p(ee,null,ae(l(n).production_companies,s=>(b(),p("article",{key:s.id,class:"company",tabindex:"0","aria-label":"Production company"},[s.logo_path?(b(),p("img",{key:0,src:`https://image.tmdb.org/t/p/w200${s.logo_path}`,alt:s.name,loading:"lazy"},null,8,Ne)):(b(),p("p",Se,D(s.name),1))]))),128))])])):B("",!0)])):(b(),p("div",Oe,"Loading movie details..."))}},Le=Z(Me,[["__scopeId","data-v-886d68cd"]]);export{Le as default};
