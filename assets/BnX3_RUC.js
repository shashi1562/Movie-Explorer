const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BqmV3Iao.js","./TJ7jymPr.js","./entry.JUNimcXe.css","./fNJ1jaIx.js","./MovieCard.DgLu6_qK.css"])))=>i.map(i=>d[i]);
import{j as A,_ as B,s as F,r as L,k as x,l as I,c as m,o as i,a as l,b as k,m as P,v as V,n as E,p as U,q,F as T,x as N,t as C,y as z,w as S,z as M,T as w,A as a,B as $,S as R,C as j,D as O}from"./TJ7jymPr.js";import{u as D}from"./BVJTnKT0.js";const Y=A("search",{state:()=>({title:"",year:"",genre:""}),actions:{setSearch({title:o,year:h,genre:y}){this.title=o,this.year=h,this.genre=y}},persist:!0}),H={class:"search-wrapper"},J={disabled:""},K=["value"],Q={key:0,class:"error"},W={__name:"SearchForm",emits:["submit"],setup(o,{emit:h}){const y=h,c=Y(),{title:_,year:d,genre:f}=F(c),t=L({get title(){return _.value},set title(e){_.value=e},get year(){return d.value},set year(e){d.value=e},get genre(){return f.value},set genre(e){f.value=e}}),v=x(""),b=x([]),g=x(!1),{fetchGenres:u}=D(),r=async()=>{g.value=!0;try{const e=await u();b.value=e.genres||[]}catch(e){console.error("Failed to load genres:",e),v.value="Could not load genres."}finally{g.value=!1}};I(()=>{r()});const p=()=>{if(!t.title.trim()){v.value="Movie title is required.";return}v.value="",y("submit",{title:t.title,year:t.year,genre:t.genre})};return(e,s)=>(i(),m("div",H,[l("form",{class:"search-form",onSubmit:z(p,["prevent"])},[P(l("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t.title=n),placeholder:"Movie Title",class:E({invalid:v.value&&!t.title.trim()})},null,2),[[V,t.title]]),P(l("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t.year=n),type:"number",placeholder:"Year"},null,512),[[V,t.year]]),P(l("select",{"onUpdate:modelValue":s[2]||(s[2]=n=>t.genre=n)},[s[3]||(s[3]=l("option",{value:""},"All Genres",-1)),P(l("option",J,"Loading...",512),[[q,g.value]]),(i(!0),m(T,null,N(b.value,n=>(i(),m("option",{key:n.id,value:n.id},C(n.name),9,K))),128))],512),[[U,t.genre]]),s[4]||(s[4]=l("button",{type:"submit",class:"submit-button"},"Search",-1))],32),k(w,{name:"fade-slide"},{default:S(()=>[v.value?(i(),m("p",Q,C(v.value),1)):M("",!0)]),_:1})]))}},X=B(W,[["__scopeId","data-v-4a780cae"]]),Z=A("movies",{state:()=>({movies:[],currentPage:1,totalPages:1,searchParams:{title:"",year:"",genre:""}}),actions:{setMovies(o){this.movies=o},setCurrentPage(o){this.currentPage=o},setTotalPages(o){this.totalPages=o},setSearchParams(o){this.searchParams=o}},persist:!0}),ee={key:0,class:"movie-grid"},te={key:0,class:"empty-state"},se={key:0,class:"pagination-controls"},ae=["disabled"],re={class:"page-info"},oe=["disabled"],ne={__name:"index",setup(o){const h=j(()=>O(()=>import("./BqmV3Iao.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),{searchMovies:y}=D(),c=Z(),{movies:_,currentPage:d,totalPages:f,searchParams:t}=F(c);function v({title:u,year:r,genre:p}){c.setSearchParams({title:u,year:r,genre:p}),c.setCurrentPage(1),g()}function b(u){c.setCurrentPage(u),g().then(()=>{window.scrollTo({top:0,behavior:"smooth"})})}async function g(){try{const{title:u,year:r,genre:p}=t.value,e=await y(u,r,d.value);let s=e.results||[];if(c.setTotalPages(e.total_pages||1),p){const n=parseInt(p);s=s.filter(G=>G.genre_ids?.includes(n))}c.setMovies(s)}catch(u){console.error("Search failed:",u),c.setMovies([])}}return I(()=>{t.value.title&&g()}),(u,r)=>{const p=X;return i(),m(T,null,[k(p,{onSubmit:v}),k(w,{name:"fade-slide"},{default:S(()=>[a(_).length?(i(),m("div",ee,[(i(),$(R,null,{default:S(()=>[(i(!0),m(T,null,N(a(_),e=>(i(),$(a(h),{key:e.id,movie:e,class:"fade-in"},null,8,["movie"]))),128))]),fallback:S(()=>r[2]||(r[2]=[l("div",{class:"loading"},"Loading results...",-1)])),_:1}))])):M("",!0)]),_:1}),k(w,{name:"fade-slide"},{default:S(()=>[!a(_).length&&a(t).title?(i(),m("p",te,"No results found. Try another search ðŸŽ¬")):M("",!0)]),_:1}),a(f)>1?(i(),m("div",se,[l("button",{onClick:r[0]||(r[0]=e=>b(a(d)-1)),disabled:a(d)===1,class:"page-btn"}," â—€ Prev ",8,ae),l("span",re,"Page "+C(a(d))+" of "+C(a(f)),1),l("button",{onClick:r[1]||(r[1]=e=>b(a(d)+1)),disabled:a(d)===a(f),class:"page-btn"}," Next â–¶ ",8,oe)])):M("",!0)],64)}}},ue=B(ne,[["__scopeId","data-v-826db61d"]]);export{ue as default};
