const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B_n7wUSp.js","./C7FrW0wO.js","./entry.JUNimcXe.css","./CGVNEQCG.js","./MovieCard.DCW1-DXe.css"])))=>i.map(i=>d[i]);
import{j as D,_ as E,s as G,r as R,k as P,c as d,o as n,a as l,b as k,l as M,v as B,n as j,m as O,w as y,p as b,t as C,T as V,q as F,x as Y,y as H,z as e,F as T,A as I,B as J,C as N,S as K,D as Q,E as W}from"./C7FrW0wO.js";import{u as $}from"./Bhvm3E0M.js";const X=D("search",{state:()=>({title:"",year:"",genre:""}),actions:{setSearch({title:i,year:f,genre:g}){this.title=i,this.year=f,this.genre=g}},persist:!0}),Z={class:"search-wrapper"},ee={key:0,class:"error"},te={__name:"SearchForm",emits:["submit"],setup(i,{emit:f}){const g=f,u=X(),{title:p,year:m}=G(u),r=R({get title(){return p.value},set title(v){p.value=v},get year(){return m.value},set year(v){m.value=v}}),s=P(""),w=()=>{if(!r.title.trim()){s.value="Movie title is required.";return}s.value="",g("submit",{title:r.title,year:r.year})};return(v,c)=>(n(),d("div",Z,[l("form",{class:"search-form",onSubmit:O(w,["prevent"])},[M(l("input",{"onUpdate:modelValue":c[0]||(c[0]=h=>r.title=h),placeholder:"Movie Title",class:j({invalid:s.value&&!r.title.trim()})},null,2),[[B,r.title]]),M(l("input",{"onUpdate:modelValue":c[1]||(c[1]=h=>r.year=h),type:"number",placeholder:"Year"},null,512),[[B,r.year]]),c[2]||(c[2]=l("button",{type:"submit",class:"submit-button"},"Search",-1))],32),k(V,{name:"fade-slide"},{default:y(()=>[s.value?(n(),d("p",ee,C(s.value),1)):b("",!0)]),_:1})]))}},se=E(te,[["__scopeId","data-v-e52ba1dc"]]),ae=D("movies",{state:()=>({movies:[],currentPage:1,totalPages:1,searchParams:{title:"",year:"",genre:""}}),actions:{setMovies(i){this.movies=i},setCurrentPage(i){this.currentPage=i},setTotalPages(i){this.totalPages=i},setSearchParams(i){this.searchParams=i}},persist:!0}),re={class:"sort-bar"},oe={key:0,disabled:""},ne=["value"],le={key:0,class:"movie-grid"},ie={key:0,class:"empty-state"},ue={key:0,class:"pagination-controls"},ce=["disabled"],de={class:"page-info"},me=["disabled"],ve={__name:"index",setup(i){const f=Q(()=>W(()=>import("./B_n7wUSp.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),{searchMovies:g}=$(),u=ae(),{movies:p,currentPage:m,totalPages:r,searchParams:s}=G(u);function w({title:o,year:t,genre:_}){u.setSearchParams({title:o,year:t,genre:_}),u.setCurrentPage(1),S()}const v=P([]),c=P(!1),h=P(""),{fetchGenres:L}=$(),U=async()=>{c.value=!0;try{const o=await L();v.value=o.genres||[]}catch(o){console.error("Failed to load genres:",o),h.value="Could not load genres."}finally{c.value=!1}};F(()=>{U()}),Y(()=>s.value.genre,()=>{u.setCurrentPage(1),S()});function A(o){u.setCurrentPage(o),S().then(()=>{window.scrollTo({top:0,behavior:"smooth"})})}async function S(){try{const{title:o,year:t,genre:_}=s.value,a=await g(o,t,m.value);let x=a.results||[];if(u.setTotalPages(a.total_pages||1),_){const q=parseInt(_);x=x.filter(z=>z.genre_ids?.includes(q))}u.setMovies(x)}catch(o){console.error("Search failed:",o),u.setMovies([])}}return F(()=>{s.value.title&&S()}),(o,t)=>{const _=se;return n(),d(T,null,[k(_,{onSubmit:w}),M(l("div",re,[t[4]||(t[4]=l("label",{for:"sort",class:"sort-label"},"Sort by:",-1)),M(l("select",{id:"sort","onUpdate:modelValue":t[0]||(t[0]=a=>e(s).genre=a),class:"sort-select"},[t[3]||(t[3]=l("option",{value:""},"All Genres",-1)),e(c)?(n(),d("option",oe,"Loading...")):b("",!0),(n(!0),d(T,null,I(e(v),a=>(n(),d("option",{key:a.id,value:a.id},C(a.name),9,ne))),128))],512),[[J,e(s).genre]])],512),[[H,e(s).title]]),k(V,{name:"fade-slide"},{default:y(()=>[e(p).length?(n(),d("div",le,[(n(),N(K,null,{default:y(()=>[(n(!0),d(T,null,I(e(p),a=>(n(),N(e(f),{key:a.id,movie:a,class:"fade-in"},null,8,["movie"]))),128))]),fallback:y(()=>t[5]||(t[5]=[l("div",{class:"loading"},"Loading results...",-1)])),_:1}))])):b("",!0)]),_:1}),k(V,{name:"fade-slide"},{default:y(()=>[!e(p).length&&e(s).title?(n(),d("p",ie,"No results found. Try another search ðŸŽ¬")):b("",!0)]),_:1}),e(r)>1?(n(),d("div",ue,[l("button",{onClick:t[1]||(t[1]=a=>A(e(m)-1)),disabled:e(m)===1,class:"page-btn"}," â—€ Prev ",8,ce),l("span",de,"Page "+C(e(m))+" of "+C(e(r)),1),l("button",{onClick:t[2]||(t[2]=a=>A(e(m)+1)),disabled:e(m)===e(r),class:"page-btn"}," Next â–¶ ",8,me)])):b("",!0)],64)}}},fe=E(ve,[["__scopeId","data-v-e956f75b"]]);export{fe as default};
